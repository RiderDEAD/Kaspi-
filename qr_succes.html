<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Оплата совершена</title>

    <style>
        /* ===== SF PRO ===== */
        @font-face {
            font-family: 'SF Pro Text';
            src: url('SFProText-Regular.ttf') format('truetype');
            font-weight: 400;
        }
        @font-face {
            font-family: 'SF Pro Text';
            src: url('SFProText-Semibold.ttf') format('truetype');
            font-weight: 600;
        }

        :root {
            --font-main: 'SF Pro Text', -apple-system, sans-serif;
            --kaspi-blue: #0089d0;
            --kaspi-green: #28cd41;
            --bg-gray: #f2f2f7;
            --text-secondary: #8e8e93;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: var(--font-main); }

        html, body { margin: 0; padding: 0; height: 100%; background: var(--bg-gray); overflow-x: hidden; }

        /* HEADER */
        .fixed-header {
            background: #fff;
            padding: calc(14px + env(safe-area-inset-top)) 16px 14px;
            text-align: center; font-size: 17px; font-weight: 600;
            border-bottom: 0.5px solid #e5e5ea;
        }

        .scrollable-content { height: calc(100% - 140px); overflow-y: auto; padding-bottom: 100px; }

        /* SUCCESS BLOCK */
        .success-container { background: #fff; padding: 30px 16px; text-align: center; }

        .check-icon {
            width: 50px; height: 50px; margin: 0 auto 15px;
            background: var(--kaspi-green); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
        }
        .check-icon::after {
            content: ''; width: 10px; height: 20px; border: solid #fff;
            border-width: 0 3.5px 3.5px 0; transform: rotate(45deg); margin-top: -3px;
        }

        .thanks-text { font-size: 20px; font-weight: 600; margin-bottom: 8px; color: #000; }
        .amount-text { font-size: 36px; font-weight: 700; margin-bottom: 20px; }

        /* INFO GRID */
        .info-grid {
            display: grid; grid-template-columns: 1fr 1.2fr;
            border-top: 0.5px solid #f2f2f7; padding-top: 15px; text-align: left;
        }
        .info-label { font-size: 13px; color: var(--text-secondary); margin-bottom: 4px; }
        .info-value { font-size: 15px; color: #000; font-weight: 400; }

        /* RECEIPT LINK */
        .receipt-action {
            background: #fff; margin-top: 12px; padding: 16px;
            display: flex; align-items: center; justify-content: space-between;
        }
        .receipt-left { display: flex; align-items: center; }
        .receipt-icon { width: 24px; height: 24px; margin-right: 12px; opacity: 0.7; }
        .receipt-title { font-size: 15px; color: #000; }
        .receipt-sub { font-size: 13px; color: var(--text-secondary); }
        .arrow-right { color: #c7c7cc; font-size: 20px; }

        /* RECOMMENDATIONS */
        .recs-section { padding: 20px 16px; }
        .recs-title { font-size: 15px; font-weight: 600; margin-bottom: 12px; }
        .recs-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .rec-card { background: #fff; border-radius: 12px; padding: 10px; position: relative; }
        .rec-img { width: 100%; aspect-ratio: 1; object-fit: contain; margin-bottom: 8px; }
        .rec-price { 
            display: inline-block; background: #e8f5e9; color: #2e7d32; 
            font-size: 11px; font-weight: 700; padding: 2px 6px; border-radius: 4px;
        }

        /* FOOTER BUTTON */
        .footer {
            position: fixed; bottom: 0; left: 0; width: 100%;
            padding: 16px 16px calc(20px + env(safe-area-inset-bottom));
            background: var(--bg-gray);
        }
        .btn-main {
            width: 100%; padding: 16px; border: none; border-radius: 12px;
            background: var(--kaspi-blue); color: #fff;
            font-size: 16px; font-weight: 600; cursor: pointer;
        }
    </style>
</head>

<body>

    <div class="fixed-header">Оплата</div>

    <div class="scrollable-content">
        <div class="success-container">
            <div class="check-icon"></div>
            <div class="thanks-text">Спасибо за покупку</div>
            <div class="amount-text"><span id="finalSum">0</span> ₸</div>

            <div class="info-grid">
                <div>
                    <div class="info-label">Продавец</div>
                    <div class="info-value" id="success-seller-name">Загрузка...</div>
                </div>
                <div>
                    <div class="info-label">Дата покупки</div>
                    <div class="info-value" id="currentDate">-</div>
                </div>
            </div>
        </div>

        <div class="receipt-action">
            <div class="receipt-left">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23e53935'%3E%3Cpath d='M14,2H6C4.9,2,4,2.9,4,4v16c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V8L14,2z M16,18H8v-2h8V18z M16,14H8v-2h8V14z M13,9V3.5L18.5,9H13z'/%3E%3C/svg%3E" class="receipt-icon">
                <div>
                    <div class="receipt-title">Показать чек об оплате</div>
                    <div class="receipt-sub">Чек сохранен в сообщениях</div>
                </div>
            </div>
            <div class="arrow-right">›</div>
        </div>

        <div class="recs-section">
            <div class="recs-title">Вас могут заинтересовать</div>
            <div class="recs-grid">
                <div class="rec-card">
                    <img src="add_1.png" class="rec-img">
                    <div class="rec-price">10 393 ₸</div>
                </div>
                <div class="rec-card">
                    <img src="add_2.png" class="rec-img">
                    <div class="rec-price">1 320 ₸</div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <button class="btn-main" onclick="location.href='index.html'">Вернуться на Главную Kaspi.kz</button>
    </div>

    <script>
        window.onload = function() {
            // 1. Вывод суммы
            const savedAmount = localStorage.getItem('last_payment_amount') || "0";
            const formatted = Number(savedAmount).toLocaleString('ru-RU');
            document.getElementById('finalSum').innerText = formatted;

            // 2. Вывод продавца (НОВОЕ)
            const savedSeller = localStorage.getItem('last_seller_name') || "Продавец не указан";
            document.getElementById('success-seller-name').innerText = savedSeller;

            // 3. Вывод текущей даты (15 февраля, 21:48)
            const now = new Date();
            const months = ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря'];
            const day = now.getDate();
            const month = months[now.getMonth()];
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            
            document.getElementById('currentDate').innerText = `${day} ${month}, ${hours}:${minutes}`;

            // 4. Haptic
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
            }
        };
    </script>

</body>
</html>
